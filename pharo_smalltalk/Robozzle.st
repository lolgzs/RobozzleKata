Object subclass: #RShip	instanceVariableNames: 'positions translation'	classVariableNames: ''	poolDictionaries: ''	category: 'Robozzle'!!RShip methodsFor: 'accessing' stamp: 'LaurentLaffont 2/28/2012 13:49'!at: aPoint	positions := self positions add: aPoint; yourself.! !!RShip methodsFor: 'accessing' stamp: 'LaurentLaffont 2/28/2012 21:17'!position	^ self positions last! !!RShip methodsFor: 'accessing' stamp: 'LaurentLaffont 2/28/2012 13:48'!positions	^ positions ifNil: [positions := OrderedCollection new]! !!RShip methodsFor: 'accessing' stamp: 'LaurentLaffont 2/28/2012 21:35'!translation	^  translation ifNil: [self north. translation].	! !!RShip methodsFor: 'commands' stamp: 'LaurentLaffont 2/28/2012 21:16'!forward	self positions add: (self position translateBy: self translation).! !!RShip methodsFor: 'commands' stamp: 'LaurentLaffont 2/28/2012 21:40'!left	translation := self translation y negated @ self translation x.	self positions add: self position.! !!RShip methodsFor: 'commands' stamp: 'LaurentLaffont 2/28/2012 21:40'!right	translation := self translation y @ self translation x negated.	self positions add: self position.! !!RShip methodsFor: 'directions' stamp: 'LaurentLaffont 2/28/2012 21:37'!east	translation := 1@0! !!RShip methodsFor: 'directions' stamp: 'LaurentLaffont 2/28/2012 21:37'!north	translation := 0@1! !!RShip methodsFor: 'directions' stamp: 'LaurentLaffont 2/28/2012 21:38'!south	translation := 0@ 1 negated! !!RShip methodsFor: 'directions' stamp: 'LaurentLaffont 2/28/2012 21:38'!west	translation := 1 negated @0! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!RShip class	instanceVariableNames: ''!!RShip class methodsFor: 'as yet unclassified' stamp: 'LaurentLaffont 2/28/2012 13:46'!at: aPoint	^ self new at: aPoint! !TestCase subclass: #RShipTest	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'Robozzle'!!RShipTest methodsFor: 'tests' stamp: 'LaurentLaffont 2/28/2012 21:39'!testMovingShipForward	self assert: 0@13 equals: (RShip at: 0@12) north forward position.	self assert: 0@11 equals: (RShip at: 0@12) south forward position.	self assert: 1@12 equals: (RShip at: 0@12) east forward position.	self assert: 1 negated@12 equals: (RShip at: 0@12) west forward position.! !!RShipTest methodsFor: 'tests' stamp: 'LaurentLaffont 2/28/2012 21:39'!testTurningShipToLeft	self assert: 17@12 equals: (RShip at: 18@12) north left forward position.		self assert: 18@11 equals: (RShip at: 18@12) north left left forward position.! !!RShipTest methodsFor: 'tests' stamp: 'LaurentLaffont 2/28/2012 21:39'!testTurningShipToRight	self assert: 19@12 equals: (RShip at: 18@12) north right forward position.		self assert: 18@11 equals: (RShip at: 18@12) north right right forward position.! !Object subclass: #Robozzle	instanceVariableNames: 'stars ship numberOfMoves'	classVariableNames: ''	poolDictionaries: ''	category: 'Robozzle'!!Robozzle methodsFor: 'accessing' stamp: 'LaurentLaffont 2/28/2012 13:18'!numberOfMoves: aSmallInteger 	numberOfMoves := aSmallInteger.! !!Robozzle methodsFor: 'accessing' stamp: 'LaurentLaffont 2/28/2012 13:18'!ship: aRShip 	ship := aRShip.! !!Robozzle methodsFor: 'accessing' stamp: 'LaurentLaffont 2/28/2012 21:06'!shipPositions	^ ship positions first: numberOfMoves + 1! !!Robozzle methodsFor: 'accessing' stamp: 'LaurentLaffont 2/28/2012 13:12'!stars: anArray 	stars:=anArray.! !!Robozzle methodsFor: 'testing' stamp: 'LaurentLaffont 2/28/2012 21:05'!isLevelCompleted	^ (stars copyWithoutAll: self shipPositions) isEmpty! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Robozzle class	instanceVariableNames: ''!!Robozzle class methodsFor: 'instance creation' stamp: 'LaurentLaffont 2/28/2012 13:21'!stars: anArray ship: aRShip numberOfMoves: aSmallInteger 	^ (self new) 		stars: anArray;		ship: aRShip;		numberOfMoves:aSmallInteger.	! !!Robozzle class methodsFor: 'as yet unclassified' stamp: 'LaurentLaffont 2/28/2012 13:19'!isLevelCompleted	self shouldBeImplemented.! !TestCase subclass: #RobozzleTest	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'Robozzle'!!RobozzleTest methodsFor: 'tests' stamp: 'LaurentLaffont 2/28/2012 21:34'!testAcceptanceTest	| robozzle ship |	ship := RShip at:0@0.	robozzle := Robozzle stars: {2 negated@0.  2@0} ship: ship numberOfMoves: 9.	ship 		right 		forward 		forward 		left 		left 		forward 		forward 		forward 		forward.	self assert: robozzle isLevelCompleted.! !!RobozzleTest methodsFor: 'tests' stamp: 'LaurentLaffont 2/28/2012 13:05'!testIfShipLiesOnOnlyStarInLevelThenLevelCompletedEvenIfShipDoesNotMove	| robozzle |	robozzle := Robozzle stars: {0@0} ship: (RShip at: 0@0) numberOfMoves: 0. 	self assert: robozzle isLevelCompleted.! !!RobozzleTest methodsFor: 'tests' stamp: 'LaurentLaffont 2/28/2012 13:42'!testIfShipMovesOntoOnlyStarInLevelThenLevelCompleted	| robozzle ship |	ship := RShip at:0@0.	robozzle := Robozzle stars: {0@1} ship: ship numberOfMoves: 1. 	ship forward.	self assert: robozzle isLevelCompleted.! !!RobozzleTest methodsFor: 'tests' stamp: 'LaurentLaffont 2/28/2012 13:26'!testIfStarLiesSomewhereElseAndShipDoesNotMoveThenLevelNotCompleted	| robozzle |	robozzle := Robozzle stars: {0@1} ship: (RShip at: 0@0) numberOfMoves: 0. 	self deny: robozzle isLevelCompleted.! !!RobozzleTest methodsFor: 'tests' stamp: 'LaurentLaffont 2/28/2012 13:50'!testifShipHitsAllStarsButNotWithinAllowedNumberOfMovesThenLevelNotCompleted	| robozzle ship |	ship := RShip at:0@0.	robozzle := Robozzle stars: {0@1} ship: ship numberOfMoves: 0.	ship forward.	self deny: robozzle isLevelCompleted.! !